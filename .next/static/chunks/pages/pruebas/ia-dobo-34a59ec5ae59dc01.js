(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[990],{5545:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var a=n(7876),i=n(4232);let r=[{id:1,name:"Maceta 01",img:"/maceta1.png"},{id:2,name:"Maceta 02",img:"/maceta2.png"},{id:3,name:"Maceta 03",img:"/maceta3.png"}],l=[{id:1,name:"Planta 01",img:"/planta1.png"},{id:2,name:"Planta 02",img:"/planta2.png"},{id:3,name:"Planta 03",img:"/planta3.png"}];function o(){let[e,t]=(0,i.useState)(0),[o,s]=(0,i.useState)(0),[d,c]=(0,i.useState)(""),[g,u]=(0,i.useState)(null),[p,h]=(0,i.useState)(!1),m=(0,i.useRef)(null),x=(0,i.useRef)(null),f=(0,i.useRef)(null),b=r[e],y=l[o];(0,i.useEffect)(()=>((async function e(){let e=m.current;if(!e)return;let t=await n.e(965).then(n.bind(n,6162)),a=t.fabric||t.default||t;x.current&&x.current.dispose();let i=new a.Canvas(e,{backgroundColor:"#fafafa",selection:!1});x.current=i;let r=i.getWidth(),l=i.getHeight(),o=e=>new Promise((t,n)=>{a.Image.fromURL(e,a=>a?t(a):n(e),{crossOrigin:"anonymous"})});try{let e=await o(b.img),t=.7*r/e.width;e.set({left:r/2,top:.62*l,originX:"center",originY:"center",selectable:!1}),e.scale(t),i.add(e);let n=await o(y.img),a=.6*r/n.width;if(n.set({left:r/2,top:.22*l,originX:"center",originY:"center",selectable:!1}),n.scale(a),i.add(n),g){let e=await o(g),t=.45*r/e.width;e.set({left:r/2,top:.63*l,originX:"center",originY:"center",selectable:!0}),e.scale(t),i.add(e),f.current=e,i.setActiveObject(e)}else f.current=null;i.renderAll()}catch(e){console.error("Error cargando im\xe1genes:",e)}})(),()=>{}),[e,o,g]);let j=async()=>{if(!d.trim())return void alert("Escribe una descripci\xf3n.");h(!0);try{let e=await fetch("/api/generar-diseno",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:d,macetaName:b.name,plantaName:y.name})}),t=await e.json();if(t.error&&(console.error(t.error),alert("Error generando dise\xf1o.")),t.imageBase64){let e="data:image/png;base64,".concat(t.imageBase64);u(e)}}catch(e){console.error("Error:",e),alert("No se pudo generar el dise\xf1o.")}h(!1)},w=(e,t)=>{let n=document.createElement("a");n.href=e,n.download=t,n.click()},v=async()=>{let e=f.current;if(!e)return void alert("No hay dise\xf1o IA a\xfan.");let t=await n.e(965).then(n.bind(n,6162)),a=t.fabric||t.default||t,i=e.getScaledWidth(),r=e.getScaledHeight(),l=new a.Canvas(document.createElement("canvas"),{width:i,height:r}),o=a.util.object.clone(e);o.set({left:i/2,top:r/2,originX:"center",originY:"center"}),l.add(o),l.renderAll(),w(l.toDataURL({format:"png",multiplier:2}),"dobo-design-ia.png"),l.dispose()};return(0,a.jsxs)("div",{style:{padding:20,maxWidth:1200,margin:"0 auto"},children:[(0,a.jsx)("h2",{style:{textAlign:"center"},children:"DOBO – Prototipo IA"}),(0,a.jsxs)("div",{style:{display:"flex",gap:20,flexWrap:"wrap"},children:[(0,a.jsxs)("div",{style:{flex:"1 1 300px",border:"1px solid #ccc",padding:10,borderRadius:12},children:[(0,a.jsx)("h4",{style:{textAlign:"center"},children:"Maceta"}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:10},children:[(0,a.jsx)("button",{onClick:()=>t(e=>(e-1+r.length)%r.length),children:"◀"}),(0,a.jsx)("img",{src:b.img,style:{width:100}}),(0,a.jsx)("button",{onClick:()=>t(e=>(e+1)%r.length),children:"▶"})]})]}),(0,a.jsxs)("div",{style:{flex:"1 1 300px",border:"1px solid #ccc",padding:10,borderRadius:12},children:[(0,a.jsx)("h4",{style:{textAlign:"center"},children:"Planta"}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:10},children:[(0,a.jsx)("button",{onClick:()=>s(e=>(e-1+l.length)%l.length),children:"◀"}),(0,a.jsx)("img",{src:y.img,style:{width:100}}),(0,a.jsx)("button",{onClick:()=>s(e=>(e+1)%l.length),children:"▶"})]})]})]}),(0,a.jsx)("div",{style:{marginTop:30,textAlign:"center"},children:(0,a.jsx)("canvas",{ref:m,width:600,height:600,style:{width:"100%",maxWidth:600,background:"#fafafa",borderRadius:12}})}),(0,a.jsxs)("div",{style:{marginTop:20},children:[(0,a.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),placeholder:"Describe el dise\xf1o que quieres...",style:{width:"100%",padding:10,minHeight:80,borderRadius:8,border:"1px solid #ccc"}}),(0,a.jsx)("button",{onClick:j,disabled:p,style:{marginTop:10,padding:"8px 20px",background:"#222",color:"white",borderRadius:8,cursor:"pointer"},children:p?"Generando...":"Generar dise\xf1o IA"})]}),(0,a.jsxs)("div",{style:{marginTop:30,display:"flex",gap:10,flexWrap:"wrap"},children:[(0,a.jsx)("button",{onClick:()=>{let e=x.current;e&&w(e.toDataURL({format:"png",multiplier:2}),"dobo-completo.png")},children:"Exportar PNG composici\xf3n"}),(0,a.jsx)("button",{onClick:v,children:"Exportar PNG dise\xf1o IA"}),(0,a.jsx)("button",{onClick:()=>{let e=f.current;if(!e)return void alert("No hay dise\xf1o IA a\xfan.");let t=new Blob([e.toSVG()],{type:"image/svg+xml"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="dobo-design-ia.svg",a.click(),URL.revokeObjectURL(n)},children:"Exportar SVG dise\xf1o IA"})]})]})}},8252:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/pruebas/ia-dobo",function(){return n(5545)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=8252)),_N_E=e.O()}]);